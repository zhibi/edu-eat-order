define("waimai:widget/common/ui/citybar/citybar",function(require,exports,module){function Citybar(t){$.extend(opt,t),bindEvent(),initHtml()}function bindEvent(){var t=opt.$el,e=0;t.on("click",function(t){e=!e,listener.trigger("city","select",{toggle:e}),t.stopPropagation()}),listener.on("muticities","selected",function(t,e){setCity(e),e.hasaoi?listener.trigger("city","hasaoi",e):listener.trigger("city","hide")}),$(document).on("click",function(){listener.trigger("city","hide")})}function setCity(t){var e=opt.$el;e.find(".current-city").html(t.name).attr("data-name",t.name).attr("data-code",t.code).attr("data-hasaoi",t.hasaoi)}function initHtml(){var t,e=opt.cityList,i=opt.currentCity;i&&i.name?CookieDataCenter.setCity(opt.currentCity):(i=CookieDataCenter.getCity(),opt.currentCity=i),t=cityBarTmpl({city_list:e,current_city:i}),opt.$el.append(t),opt.init&&opt.init(opt)}var CookieDataCenter=require("waimai:static/utils/CookieDataCenter"),cityBarTmpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div class="city-dropdown">    <div class="city-locate dropdown-toggle">        <a class="current-city" data-name="',"undefined"==typeof current_city.name?"":baidu.template._encodeHTML(current_city.name),'" data-code="',"undefined"==typeof current_city.code?"":baidu.template._encodeHTML(current_city.code),'">',"undefined"==typeof current_city.name?"":baidu.template._encodeHTML(current_city.name),'</a>        <b class="arrow"></b>    </div>    <div class="dropdown-menu hide">        <!-- <div class="city-disabled">已开通城市</div>        <ul class="city-list">            ');for(var i=0,len=city_list.length;len>i;i++){var item=city_list[i];_template_fun_array.push('                <li class="city-item" data-name = "',"undefined"==typeof item.name?"":baidu.template._encodeHTML(item.name),'" data-code = "',"undefined"==typeof item.code?"":baidu.template._encodeHTML(item.code),'">',"undefined"==typeof item.name?"":baidu.template._encodeHTML(item.name),"</li>            ")}_template_fun_array.push("        </ul> -->    </div></div>"),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],exports,opt={$el:null,cityList:[],currentCity:null,init:null};exports=module.exports=Citybar});