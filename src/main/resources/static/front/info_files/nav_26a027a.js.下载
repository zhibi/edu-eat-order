define("waimai:widget/common/nav/nav",function(require,exports,module){function getBasicUrl(){return"/waimai/shoplist/"+hashKeyId}function hideSearch(){$searchEl.removeClass("s-active")}function showSearch(){$searchEl.addClass("s-active"),$searchEl.find(".s-second .s-con").val(""),$searchEl.find(".s-second .s-con").focus(),$(Search).trigger("show.history"),$(Search).trigger("address.hide.history")}function showCircle(e){var i=CookieDataCenter.getCity(i);i.hasaoi?($searchEl.addClass("s-active"),$searchEl.find(".s-second .s-con").val(""),$searchEl.find(".s-second .s-con").focus(),listener.trigger("city","hasaoi",i),$(Search).trigger("hide.history")):showSearch(),e&&e.stopPropagation()}function initEvent(){navList.on("click.nav",function(e){var i=$(this).attr("id"),a=this;return"order"===i?(e.preventDefault(),void require.async(["waimai:widget/common/userinfo/UserMgr"],function(e){e.login({url:$(a).find(".nav-item-link").prop("href")})})):void $(this).addClass("nav-item-active")}),$searchEl.find(".s-first .s-con").on("click",showCircle),$searchEl.find(".s-second .s-con").on("click",showCircle),$searchEl.find("#s-con").on("keyup focus",function(e){var i=$(e.currentTarget),a=i.val(),t=CookieDataCenter.getCity();t.hasaoi&&""===a?setTimeout(function(){listener.trigger("city","hasaoi",t),$(Search).trigger("hide.history")},0):listener.trigger("city","hide")}),listener.on("muticities","selected",function(){showCircle()}),$(document).on("click",hideSearch),$searchEl.hover(function(){$(document).unbind("click",hideSearch)},function(){$(document).on("click",hideSearch)}),listener.on("city","select",function(){$(Search).trigger("hide.history")}),$("#f-search").on("click",function(){if(addNStat({da_src:"searchShopBk.searchBtn",da_act:"click",da_trd:"waimai"}),$("#f-input").val()){var e=getBasicUrl(),i=e+"?wd="+$("#f-input").val()+(_welfareElse?"&welfare="+_welfareElse:"");window.location.href=i}else $("#f-input").focus()}),$("#f-input").on("keydown",function(e){return 13==e.which?void $("#f-search").click():void 0})}function initCityBar(){}function searchEvent(){$searchList.delegate("li a","click",function(e){e.preventDefault();var i=this.href,a=$(this).data("type"),t="nav-sug-shop"==a,s="nav-sug-dish"==a;addNStat({da_src:"SugListBk.clickSearchList",da_act:"click",da_trd:"waimai"}),t&&addNStat({da_src:"SugListBk.clickSearchShopList",da_act:"click",da_trd:"waimai"}),s&&addNStat({da_src:"SugListBk.clickSearchDishList",da_act:"click",da_trd:"waimai"}),window.location=i}),$searchInput.on("input propertychange",function(e){if(hashKeyId){{var i=$searchInput.val();$(this)}40!==e.keyCode&&38!==e.keyCode&&39!==e.keyCode&&41!==e.keyCode&&$.ajax({url:"/shopui?qt=shopdishsuggest&addr_id="+hashKeyId+"&word="+encodeURIComponent(i)+"&pre_only=0&page_num=0&range_num=5&"+Math.random(),type:"GET",dataType:"JSON",success:function(e){e&&0==e.error_no&&e.result?renderSearchList(e.result):$searchList.hide()},error:function(){$searchList.hide()}})}else{$searchList.html("");var a="";a='<li><span class="f-search-txt"><img class="jumpDirectImg" src="'+jumpDirectImg+'">请先填写您的地址</span></li>',$searchList.html(a),$searchList.show()}}),$searchInput.on("focus",function(){$searchList.children().length>0&&($searchList.show(),addNStat({da_src:"SugListBk.showSearchList",da_act:"show",da_trd:"waimai"}))}),$searchInput.on("focusout",function(){setTimeout(function(){$searchList.hide()},300)})}function renderSearchList(e){for(var i=0;i<e.shop_sug_list.length;i++){var a=decodeURIComponent(e.shop_sug_list[i].shop_logo.substring(109));if(a.match(/http:\/\/([^\/]+)/i)){a.match(/http:\/\/([^\/]+)/i)}else{a.match(/https:\/\/([^\/]+)/i)}e.shop_sug_list[i].shop_logo=a}var t=navSugTpl(convertSug(e));$searchList.html(t),$searchList.children().length>0?($searchList.show(),addNStat({da_src:"SugListBk.showSearchList",da_act:"show",da_trd:"waimai"})):$searchList.hide()}function convertSug(e){function i(e,i){var a=e.businessStatus;e.classWait="",1===a||4===a?(e.tip="店铺"+BUSS_STATUS[a],e.classWait="wait"):2===a||5===a?(e.tip=e.takeout_open_time+"开始配送",e.classWait="start"):e.tip="shop"===i?e.sell_month_count+"份":"¥ "+e.price}for(var a=e.dish_sug_list,t=e.shop_sug_list,s=a.length,n=t.length,o=0,r=0;s>o;o++){var c=a[o];i(c,"dish")}for(;n>r;r++){var c=t[r];i(c,"shop")}return e.recall_info=recall_info,e}function sys_timeout(){var e=864e5,i=(new Date).getTime(),a=new Fingerprint({canvas:!0,ie_activex:!0,screen_resolution:!0}),t=a.get(),s=a.getKey();cookie.setRaw("SYS_CONFIRM",JSON.stringify(s),{expires:i+365*e,path:"/"}),cookie.setRaw("SYS_TIMEOUT",t,{expires:i+365*e,path:"/"})}var util=require("wcommon:static/util"),Fingerprint=require("waimai:static/utils/fingerprint"),CookieDataCenter=require("waimai:static/utils/CookieDataCenter"),CityBar=require("waimai:widget/common/ui/citybar/citybar"),Search=require("waimai:widget/common/ui/navSearch/search"),cookie=require("wcommon:static/util/Cookie"),navSugTpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';if(eval(_template_varName),_template_fun_array.push(""),shop_sug_list&&shop_sug_list.length){_template_fun_array.push('<h5>商户</h5><ul class="nav-sug-list nav-sug-shop-list">');for(var i=0;i<shop_sug_list.length;i++){var shop=shop_sug_list[i];_template_fun_array.push("<li>                "),shop.is_store&&1==shop.is_store?_template_fun_array.push('                    <a href="/shopui/upc/shopview?shop_id=',"undefined"==typeof shop.id?"":baidu.template._encodeHTML(shop.id),'" title="',"undefined"==typeof shop.name?"":baidu.template._encodeHTML(shop.name),"，本月销售","undefined"==typeof shop.sell_month_count?"":baidu.template._encodeHTML(shop.sell_month_count),'份" data-type="nav-sug-shop">                        <span class="n-s-left"><img src="',"undefined"==typeof shop.shop_logo?"":baidu.template._encodeHTML(shop.shop_logo),'" onerror="util.errorImg(this);"/>',"undefined"==typeof shop.name?"":baidu.template._encodeHTML(shop.name),'</span>                        <span class="n-s-right ',"undefined"==typeof shop.classWait?"":baidu.template._encodeHTML(shop.classWait),'">',"undefined"==typeof shop.tip?"":baidu.template._encodeHTML(shop.tip),"</span>                    </a>                "):_template_fun_array.push('                    <a href="/waimai/shop/',"undefined"==typeof shop.id?"":baidu.template._encodeHTML(shop.id),'" title="',"undefined"==typeof shop.name?"":baidu.template._encodeHTML(shop.name),"，本月销售","undefined"==typeof shop.sell_month_count?"":baidu.template._encodeHTML(shop.sell_month_count),'份" data-type="nav-sug-shop">                        <span class="n-s-left"><img src="',"undefined"==typeof shop.shop_logo?"":baidu.template._encodeHTML(shop.shop_logo),'" onerror="util.errorImg(this);"/>',"undefined"==typeof shop.name?"":baidu.template._encodeHTML(shop.name),'</span>                        <span class="n-s-right ',"undefined"==typeof shop.classWait?"":baidu.template._encodeHTML(shop.classWait),'">',"undefined"==typeof shop.tip?"":baidu.template._encodeHTML(shop.tip),"</span>                    </a>                "),_template_fun_array.push("</li>")}_template_fun_array.push("</ul>")}if(_template_fun_array.push(""),dish_sug_list&&dish_sug_list.length){_template_fun_array.push('<h5>商品</h5><ul class="nav-sug-list nav-sug-dish-list">');for(var i=0;i<dish_sug_list.length;i++){var dish=dish_sug_list[i];_template_fun_array.push('<li>            <a href="/waimai/shop/',"undefined"==typeof dish.rid?"":baidu.template._encodeHTML(dish.rid),"?searchdishid=","undefined"==typeof dish.id?"":baidu.template._encodeHTML(dish.id),'" title="',"undefined"==typeof dish.name?"":baidu.template._encodeHTML(dish.name),"，","undefined"==typeof dish.ownshop?"":baidu.template._encodeHTML(dish.ownshop),"，¥","undefined"==typeof dish.price?"":baidu.template._encodeHTML(dish.price),'" data-type="nav-sug-dish"><span class="n-s-left"><span>',"undefined"==typeof dish.name?"":baidu.template._encodeHTML(dish.name),"</span><span>","undefined"==typeof dish.ownshop?"":baidu.template._encodeHTML(dish.ownshop),'</span></span><span class="n-s-right ',"undefined"==typeof dish.classWait?"":baidu.template._encodeHTML(dish.classWait),'">',"undefined"==typeof dish.tip?"":baidu.template._encodeHTML(dish.tip),"</span></a></li>")}_template_fun_array.push("</ul>")}_template_fun_array.push(""),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],navList=$(".header .nav .nav-item"),$el=$(".header"),$searchEl=$("#nav-search-section"),$searchInput=$("#f-input"),$searchList=$(".f-search-list"),cityBarObj,_welfareElse="",hashKeyId="",recall_info=null,BUSS_STATUS=["","休息中","可预订","营业中","已打烊","需预定"];jumpDirectImg="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAALCAYAAACd1bY6AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpCN0Q4NThFRkNBMjQxMUU0OTdCQkFEQzA4NzRFNUNEQiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpCN0Q4NThGMENBMjQxMUU0OTdCQkFEQzA4NzRFNUNEQiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkI3RDg1OEVEQ0EyNDExRTQ5N0JCQURDMDg3NEU1Q0RCIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkI3RDg1OEVFQ0EyNDExRTQ5N0JCQURDMDg3NEU1Q0RCIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+108lEwAAASVJREFUeNqE0z1Lw1AUxvE0plRLpxYsOumiILi02NXNoYK7+Al0cfUr6FoHLYi6OSt0FTqJgqsWhAp1sG6+IEi19n/gCVxDLj7wI6RJTu49Oc3Mz9UCMokBPlHCEH1M41u/vwf/JEIG5zrmMYWero2jgDZO0fLUGcNPpJMQS87Fko6/eMa1CqYlhwqu4mKvnhvvcIAjbdWXsr04dKqnZUHFfIWsDYeYjbcXqFe+fKGqnrqZwDaK2I8/gOXD6VHyITu/0QpP8KbntlDHGbI2DZFTxMbhEQ9YSSm4KbblF8zgHsdxG0LdWNBXa2ANu5qvtORV6Akb6ATOSAy1mj001aMdrGtwk7EZvMQqbv8sX/+ARXSd3rlfaxk1rch2cKGR6SXfMhJgANu5Pz/Ir8nUAAAAAElFTkSuQmCC",module.exports={init:function(e){("baiduwaimai.com.cn"===window.location.hostname||"baiduwaimai.com"===window.location.hostname||"www.baiduwaimai.com.cn"===window.location.hostname||"www.baiduwaimai.com"===window.location.hostname||"www.bdwaimai.com.cn"===window.location.hostname||"bdwaimai.com.cn"===window.location.hostname)&&$("#medicine").show();try{sys_timeout()}catch(i){}var a=e.hashKey;recall_info=e.recall_info,hashKeyId=a?a:CookieDataCenter.getAddr()?CookieDataCenter.getAddr().__id:void 0,hashKeyId||(hashKeyId=""),cityBarObj=new CityBar({$el:$searchEl.find(".s-citybar"),init:initCityBar}),window.Search=Search.init({$resultEl:$searchEl.find(".s-search-container1"),$searchConEl:$searchEl.find(".s-second .s-con")}),initEvent(),searchEvent()},initSwitchaddr:function(){var e,i=CookieDataCenter.getAddr()||{};e=i.address||"",$("#nav-search-section input.s-con").val(util.encodeHTML(decodeURIComponent(e)))}}});