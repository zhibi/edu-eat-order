define("waimai:widget/common/ui/popCarousel/popCarousel",function(require,exports,module){function popCarousel(i){this.opt=$.extend({},_opt,i),currentIndex=i.index||0,this.initBigPic(),this.bindEvent()}var Dialog=require("jsmod/ui/dialog"),Carousel=require("jsmod/ui/carousel"),detailTeml=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div class="pop-con">    <div class="closeBtn"></div><div class="side"><div class="icon-con" data-node="prev"><span class="icon-prev"></span></div></div>    <div class="big-pic" data-node="popContent">        </div>    <div class="side">    <div class="icon-con" data-node="next">    <span class="icon-next"></span>    </div>    </div>    <div class="clearfix"></div>    <div class="pic-list">    <div class="icons-con"  data-node="prevp">    <span class="icon-prev"></span>    </div>    <div class="list-con" data-node="listContent">    </div>    <div class="icons-con" data-node="nextp">    <span class="icon-next"></span>    </div>    </div></div>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],cacheDialog,bigPic,listPic,currentIndex=0,listCount=3,ADD_AJAX="/waimai?qt=addressmanage&type=add&display=json",UPDATE_AJAX="/waimai?qt=addressmanage&type=update&display=json",REMOVE_AJAX="/waimai?qt=addressmanage&type=del&display=json",SETDEFAULT_AJAX="/waimai?qt=addressmanage&type=set&display=json",_opt={data:[],$bigPicEl:null,$addBtn:null,$detailEl:null,listComplete:null,itemRemove:null,dialogShow:null,saveSuccess:null,reForm:!0};$.extend(popCarousel.prototype,{bindEvent:function(){var i=cacheDialog.getElement();i.on("click","[data-node=next]",function(){bigPic.next()}),i.on("click","[data-node=prev]",function(){bigPic.pre()}),i.on("click","[data-node=nextp]",function(){listPic.cur(currentIndex+listCount,void 0,!0)}),i.on("click","[data-node=prevp]",function(){listPic.cur(currentIndex-listCount,void 0,!0)})},initBigPic:function(){var i=this.opt.data,e=[],t=[];cacheDialog=new Dialog({html:detailTeml()});for(var a=cacheDialog.getElement(),n=0,o=i.length;o>n;n++)e.push('<div class="image-content"><img onerror="util.errorImg(this);" data-src="'+i[n].rsrc+'"></div>'),t.push('<div class="image-content"><img onerror="util.errorImg(this);" src="'+i[n].src+'" width="167" height="100"></div>');bigPic=new Carousel(a.find('[data-node="popContent"]'),{count:1,htmls:e}),cacheDialog.show(),$(bigPic).on("active",function(i){currentIndex=i.index;var e=this.getItem(i.index).find("img");e.prop("src",e.data("src")),listPic.cur(currentIndex)}),listPic=new Carousel(a.find('[data-node="listContent"]'),{count:3,htmls:t}),$('[data-node="listContent"]').on("click",".mod-carousel-item",function(){var i=$(this).data("index");bigPic.cur(i),listPic.cur(i)}),bigPic.cur(currentIndex)},successTip:function(i){GlobalTips.tip(i)},errorTip:function(i){GlobalTips.tip(i)},updateOpt:function(i){this.opt=$.extend({},this.opt,i)}}),module.exports=popCarousel});